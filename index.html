<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#1a2a6c">
<link rel="apple-touch-icon" href="ChatGPT Image Oct 5, 2025, 12_37_25 AM.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="GTT">
<title>éƒ­å½¤å½¤</title>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/lxgwwenkai-regular.min.css" rel="stylesheet">

<style>
  /* === iOS-compatible dimming overlay === */
  #dim-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 800;
    pointer-events: none;
  }
  
  body.raining #dim-overlay {
    opacity: 1;
  }
  
  #splash-particles {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 9998;
  pointer-events: none;
  opacity: 0.4;
  }
  /* Reset */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Background fix for iOS */
  html {
    height: 100%;
    width: 100%;
    background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    margin: 0;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  body {
    height: 100%;
    width: 100%;
    background: transparent !important;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'LXGW WenKai', 'Inter', 'PingFang SC', sans-serif;
    overflow: hidden;
    margin: 0;
    -webkit-touch-callout: none;
    -webkit-text-size-adjust: 100%;
  }

  /* Frosted panel */
  .container {
    text-align: center;
    max-width: 350px;
    width: 100%;
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: 20px;
    padding: 30px 20px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    z-index: 1;
  }
  .container::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 70%);
    z-index: -1;
  }

  .mute-btn {
    position: absolute;
    top: 10px;
    right: 12px;
    background: transparent;
    border: none;
    padding: 6px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.25s ease;
    -webkit-tap-highlight-color: transparent;
  }
  .mute-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: scale(1.05);
  }
  .mute-btn svg {
    transition: opacity 0.25s ease;
  }

  .effect-btn {
  position: absolute;
  top: 10px;
  right: 50px; /* sits left of mute button */
  background: transparent;
  border: none;
  padding: 6px;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.25s ease;
  -webkit-tap-highlight-color: transparent;
  }
  .effect-btn:hover {
  background: rgba(255, 255, 255, 0.12);
  transform: scale(1.05);
  }
  .effect-btn.active {
  background: rgba(255, 255, 255, 0.2);
  box-shadow: 0 0 6px rgba(255, 255, 255, 0.6);
  }

  /* Creamy glowy text */
  h1,
  .subtitle,
  .result-text,
  .stat-value,
  .stat-label,
  .coin-letter {
    color: #fff8e7;
    text-shadow: 0 0 2px rgba(255, 248, 231, 0.3),
                 0 0 4px rgba(255, 248, 231, 0.2),
                 0 0 6px rgba(255, 248, 231, 0.15);
  }
  .subtitle,
  .stat-label {
    text-shadow: 0 0 1px rgba(255, 248, 231, 0.2);
  }

  /* Subtitle */
  .subtitle {
    font-size: 1rem;
    margin-bottom: 25px;
    line-height: 1.5;
    font-weight: 300;
  }

  /* Enhanced Coin Design */
  .coin-container {
    perspective: 1000px;
    width: 150px;
    height: 150px;
    margin: 0 auto 20px;
    position: relative;
  }
  .coin {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 1.5s ease-in-out;
  }
  .coin.flipping {
    animation: flip 1.5s ease-in-out;
  }
  .coin-face {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 3.5rem;
    font-weight: bold;
    overflow: hidden;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    
    /* Enhanced metallic look with better shine */
    background: radial-gradient(circle at 30% 30%, 
                #f9f9f9 0%, 
                #e8e8e8 15%, 
                #c9c9c9 40%, 
                #a8a8a8 70%, 
                #8a8a8a 100%);
    border: 6px solid #d4d4d4;
    
    /* Enhanced shadows for more depth */
    box-shadow:
      0 12px 30px rgba(0, 0, 0, 0.4),
      inset 0 -10px 20px rgba(0, 0, 0, 0.5),
      inset 0 10px 20px rgba(255, 255, 255, 0.6);
  }

  /* Enhanced gleam effect */
  .coin-face::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, 
                rgba(255, 255, 255, 0.8) 0%, 
                rgba(255, 255, 255, 0.4) 20%, 
                rgba(255, 255, 255, 0.2) 40%, 
                transparent 70%);
    z-index: 1;
    pointer-events: none;
  }

  .coin-face::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: conic-gradient(from 0deg, 
                rgba(255, 255, 255, 0.8) 0deg,
                rgba(255, 255, 255, 0.4) 60deg,
                rgba(255, 255, 255, 0.2) 120deg,
                rgba(255, 255, 255, 0.1) 180deg,
                rgba(255, 255, 255, 0.2) 240deg,
                rgba(255, 255, 255, 0.4) 300deg,
                rgba(255, 255, 255, 0.8) 360deg);
    opacity: 0.6;
    animation: spinGleam 4s linear infinite;
    pointer-events: none;
    border-radius: 50%;
    z-index: 2;
  }

  @keyframes spinGleam {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .coin-front {
    transform: rotateY(0deg);
    z-index: 2;
  }
  .coin-back {
    transform: rotateY(180deg);
  }
  .coin-image-container {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    overflow: hidden;
    position: relative;
    z-index: 3;
    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3);
  }
  .coin-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Fallback coin design if images don't load */
  .coin-fallback {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    font-size: 2.5rem;
    color: #1a2a6c;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
  }

  /* Result */
  .result {
    font-size: 1.8rem;
    margin: 20px 0;
    min-height: 60px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .result-text {
    background: rgba(255, 255, 255, 0.15);
    padding: 10px 20px;
    border-radius: 50px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
  }
  .result-text.celebrate {
    animation: celebrate 0.5s ease;
    background: rgba(255, 255, 255, 0.25);
  }

  /* Button */
  button {
    background: linear-gradient(to right, #fff, #f0f0f0);
    color: #1a2a6c;
    border: none;
    padding: 12px 35px;
    font-size: 1rem;
    font-weight: 500;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    position: relative;
    overflow: hidden;
    letter-spacing: 0.5px;
    -webkit-tap-highlight-color: transparent;
  }
  button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transition: 0.5s;
  }
  button:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
  }
  button:hover::before {
    left: 100%;
  }
  button:active {
    transform: translateY(1px);
  }
  button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
    transform: none;
  }

  /* Stats */
  .stats {
    display: flex;
    justify-content: space-around;
    margin-top: 15px;
    background: rgba(255, 255, 255, 0.08);
    padding: 15px;
    border-radius: 18px;
    width: 100%;
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }
  .stat {
    text-align: center;
    position: relative;
    padding: 0 10px;
  }
  .stat::after {
    content: '';
    position: absolute;
    right: 0;
    top: 20%;
    height: 60%;
    width: 1px;
    background: rgba(255, 255, 255, 0.2);
  }
  .stat:last-child::after {
    display: none;
  }
  .stat-value {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 5px;
  }
  .stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
    letter-spacing: 0.5px;
  }

  /* Floating emojis */
  .floating-emojis {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 0;
    opacity: 0.7;
  }
  .emoji {
    position: absolute;
    font-size: 24px;
    opacity: 0;
    animation: float 8s linear infinite;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
  }
  .emoji:nth-child(3n) { animation-duration: 10s; }
  .emoji:nth-child(3n+1) { animation-duration: 12s; }
  .emoji:nth-child(3n+2) { animation-duration: 14s; }

  /* Animations */
  @keyframes flip {
    0% { transform: rotateY(0); }
    50% { transform: rotateY(1800deg); }
    100% { transform: rotateY(1980deg); }
  }
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  @keyframes float {
    0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
    10% { opacity: 0.8; }
    90% { opacity: 0.8; }
    100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
  }
  @keyframes celebrate {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }

  /* Mobile adjustments */
  @media (max-width: 500px) {
    .container { padding: 25px 15px; }
    h1 { font-size: 2rem; }
    .coin-container { width: 120px; height: 120px; }
    .coin-face { font-size: 2.5rem; }
    .stats { padding: 10px; }
    .stat-value { font-size: 1.6rem; }
    .emoji { font-size: 18px; }
  }
  
  /* === Confetti animation === */
  .confetti {
    position: fixed;
    width: 10px;
    height: 14px;
    opacity: 0.9;
    border-radius: 2px;
    z-index: 9999;
    animation: confettiFall 3s ease-out forwards;
  }
  @keyframes confettiFall {
    0% {
      transform: translateY(-10vh) translateX(0) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(110vh) translateX(var(--xShift)) rotate(720deg);
      opacity: 0;
    }
  }

  /* === Raindrops (reverted to original) === */
  .raindrop {
    position: fixed;
    top: -20px;
    width: 2px;
    height: 18px;
    background: linear-gradient(to bottom, rgba(255,255,255,0.9), rgba(255,255,255,0));
    border-radius: 1px;
    opacity: 0.7;
    z-index: 950;
    animation: fall 1.2s linear infinite;
  }
  @keyframes fall {
    0% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(100vh); opacity: 0; }
  }

</style>
</head>

<body>
<div id="dim-overlay"></div>
<canvas id="splash-particles"></canvas>
<div class="container">
  <!-- Effect Toggle Button -->
<button class="effect-btn" id="effect-btn" aria-label="Toggle visual effects">
  <!-- Cloud OFF (outline) -->
  <svg id="effect-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
       fill="none" stroke="#fff8e7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
       width="22" height="22" style="display:block;">
    <path d="M17.5 19a4.5 4.5 0 0 0 0-9 5.5 5.5 0 0 0-10.9 1A4 4 0 0 0 7 19h10.5z"/>
  </svg>

  <!-- Cloud ON (filled + glow) -->
  <svg id="effect-on" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
       fill="#fff8e7" stroke="#fff8e7" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
       width="22" height="22" style="display:none; filter: drop-shadow(0 0 6px rgba(255,255,255,0.8));">
    <path d="M17.5 19a4.5 4.5 0 0 0 0-9 5.5 5.5 0 0 0-10.9 1A4 4 0 0 0 7 19h10.5z"/>
  </svg>
</button>


  <button class="mute-btn" id="mute-btn" aria-label="Toggle sound">
    
    <svg id="mute-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#fff8e7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="22" height="22" style="display:none;">
      <path d="M11 5L6 9H2V15H6L11 19V5Z" />
      <line x1="23" y1="9" x2="17" y2="15" />
      <line x1="17" y1="9" x2="23" y2="15" />
    </svg>
    
    <svg id="unmute-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#fff8e7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="22" height="22" style="display:block;">
      <path d="M11 5L6 9H2V15H6L11 19V5Z" />
      <path d="M15.54 8.46C16.4774 9.39764 17.004 10.6692 17.004 12C17.004 13.3308 16.4774 14.6024 15.54 15.54" />
      <path d="M19.07 4.93C20.9447 6.80528 21.9979 9.34836 21.9979 12C21.9979 14.6516 20.9447 17.1947 19.07 19.07" />
    </svg>
    
  </button>
  

  <h1>æ¬¢è¿å°å®å®ï¼</h1>
  <p class="subtitle">
    è¿™åªæ˜¯ä¸€ä»¶å¹³å¸¸çš„å°äº‹ï¼Œå¹¶ä¸ä¼šå†³å®šä½ çš„è¿æ°”å®å®ã€‚ä½†å¦‚æœå®ƒèƒ½ç»™ä½ ä¸€ç‚¹ç‚¹æ¿€åŠ±ï¼Œé‚£å°±æ˜¯æˆ‘æœ€å¤§çš„å¿ƒæ„¿ã€‚
    ä¸ç®¡æ€æ ·ï¼Œä½ æ°¸è¿œæ˜¯æœ€æ£’çš„éƒ­å½¤å½¤ã€‚æˆ‘çˆ±ä½ ã€‚
  </p>

  <div class="coin-container">
    <div class="coin" id="coin">
      <div class="coin-face coin-front">
        <div class="coin-image-container">
          <img src="A.png" class="coin-image" alt="A Side" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <div class="coin-fallback" style="display:none;">A</div>
        </div>
      </div>
      <div class="coin-face coin-back">
        <div class="coin-image-container">
          <img src="B.png" class="coin-image" alt="B Side" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <div class="coin-fallback" style="display:none;">B</div>
        </div>
      </div>
    </div>
  </div>

  <div class="result">
    <div class="result-text" id="result">å®å®å¼€å§‹å§ï¼</div>
  </div>
  <button id="flip-button">ç¿»è½¬ç¡¬å¸</button>

  <div class="stats">
    <div class="stat">
      <div class="stat-value" id="a-count">0</div>
      <div class="stat-label">Aé¢æ¬¡æ•°</div>
    </div>
    <div class="stat">
      <div class="stat-value" id="total-count">0</div>
      <div class="stat-label">æ€»æ¬¡æ•°</div>
    </div>
    <div class="stat">
      <div class="stat-value" id="b-count">0</div>
      <div class="stat-label">Bé¢æ¬¡æ•°</div>
    </div>
  </div>
</div>

<div class="floating-emojis" id="emojis-container"></div>

<audio id="flip-sound" preload="auto">
  <source src="coin-flip-shimmer-85750.mp3" type="audio/mpeg">
</audio>

<audio id="bgm" loop preload="auto">
  <source src="S.mp3" type="audio/mpeg">
</audio>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const coin = document.getElementById('coin');
  const flipButton = document.getElementById('flip-button');
  const result = document.getElementById('result');
  const aCount = document.getElementById('a-count');
  const bCount = document.getElementById('b-count');
  const totalCount = document.getElementById('total-count');
  const emojisContainer = document.getElementById('emojis-container');
  const flipSound = document.getElementById('flip-sound');
  const muteBtn = document.getElementById('mute-btn');
  const muteIcon = document.getElementById('mute-icon');
  const unmuteIcon = document.getElementById('unmute-icon');
  const bgm = document.getElementById('bgm');
  const dimOverlay = document.getElementById('dim-overlay');

  const effectBtn = document.getElementById('effect-btn');
  const effectOn = document.getElementById('effect-on');
  const effectOff = document.getElementById('effect-off');

  let effectsEnabled = false; // start OFF every time
  let isMuted = true;
  flipSound.muted = true;
  bgm.muted = true;
  muteIcon.style.display = 'block';
  unmuteIcon.style.display = 'none';

  // --- EFFECT TOGGLE ---
  effectBtn.addEventListener('click', () => {
  effectsEnabled = !effectsEnabled;
  effectOn.style.display = effectsEnabled ? 'block' : 'none';
  effectOff.style.display = effectsEnabled ? 'none' : 'block';
  effectBtn.classList.toggle('active', effectsEnabled);
});

  // --- BGM AUTOPLAY ---
  function tryPlayBgm() {
    bgm.volume = 0.07;
    bgm.play().catch(() => {
      const resume = () => {
        bgm.play().catch(()=>{});
        document.removeEventListener('touchstart', resume);
        document.removeEventListener('click', resume);
      };
      document.addEventListener('touchstart', resume, { once: true });
      document.addEventListener('click', resume, { once: true });
    });
  }
  tryPlayBgm();

  // --- MUTE BUTTON ---
  muteBtn.addEventListener('click', () => {
    isMuted = !isMuted;
    muteIcon.style.display = isMuted ? 'block' : 'none';
    unmuteIcon.style.display = isMuted ? 'none' : 'block';
    flipSound.muted = isMuted;
    bgm.muted = isMuted;
  });

  // --- CONFETTI ---
  function createConfetti() {
    for (let i = 0; i < 120; i++) {
      const confetti = document.createElement('div');
      confetti.classList.add('confetti');
      confetti.style.left = Math.random() * 100 + 'vw';
      confetti.style.top = '-10vh';
      confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 80%, 60%)`;
      confetti.style.setProperty('--xShift', (Math.random() * 200 - 100) + 'px');
      confetti.style.animationDelay = (Math.random() * 0.8) + 's';
      confetti.style.animationDuration = (2.5 + Math.random() * 1.5) + 's';
      document.body.appendChild(confetti);
      setTimeout(() => confetti.remove(), 2500);
    }
  }

  // --- RAIN ---
  const thunderAudio = new Audio('thunder-soft.mp3');
  thunderAudio.volume = 0.3;
  function createRainScene() {
    document.body.classList.add('raining');
    dimOverlay.style.opacity = '1';
    const rainContainer = document.createElement('div');
    rainContainer.classList.add('rain-container');
    document.body.appendChild(rainContainer);

    for (let i = 0; i < 70; i++) {
      const drop = document.createElement('div');
      drop.classList.add('raindrop');
      drop.style.left = Math.random() * 100 + 'vw';
      drop.style.animationDuration = (0.7 + Math.random() * 0.6) + 's';
      drop.style.animationDelay = Math.random() + 's';
      rainContainer.appendChild(drop);
    }

    if (!isMuted) {
      thunderAudio.currentTime = 0;
      thunderAudio.play().catch(()=>{});
    }

    setTimeout(() => {
      dimOverlay.style.opacity = '0';
      setTimeout(() => {
        document.body.classList.remove('raining');
        rainContainer.remove();
      }, 400);
    }, 2500);
  }

  // --- COIN FLIP ---
  let isFlipping = false, aCounter = 0, bCounter = 0, totalFlips = 0;
  
  const cuteEmojis=['â¤ï¸','âœ¨','ğŸŒŸ','ğŸ¥°','ğŸ˜Š','ğŸŒ¸','ğŸ’«','ğŸ€','ğŸ’–','ğŸ¦‹','ğŸ°','ğŸ±','ğŸ¶','ğŸŒˆ','ğŸˆ','ğŸµ','ğŸ’•','ğŸ’','ğŸ’˜','ğŸ’“','ğŸ’—','ğŸ’','ğŸ’Ÿ','â£ï¸','â­','ğŸŒº','ğŸŒ·','ğŸ’','ğŸŒ¼','ğŸ¦„','ğŸ€','ğŸ‚','ğŸ¬','ğŸ­','ğŸ','ğŸ€','ğŸ‘‘','ğŸ’','ğŸ”®','ğŸµ'];

    function createEmojis(){
        for(let i=0;i<25;i++){
            const emoji=document.createElement('div');
            emoji.className='emoji';
            emoji.innerHTML=cuteEmojis[Math.floor(Math.random()*cuteEmojis.length)];
            emoji.style.left=Math.random()*100+'vw';
            emoji.style.animationDelay=Math.random()*8+'s';
            emoji.style.fontSize=(Math.random()*20+15)+'px';
            emoji.style.animation=`float ${8+Math.random()*6}s linear infinite`;
            emojisContainer.appendChild(emoji);
        }
    }
  createEmojis();

  const canvas = document.getElementById('splash-particles');
  const ctx = canvas.getContext('2d');
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  let particles = Array.from({ length:120 }, () => ({
    x: Math.random() * innerWidth,
    y: Math.random() * innerHeight,
    r: Math.random() * 2 + 1,
    dx: (Math.random() - 0.5) * 0.3,
    dy: (Math.random() - 0.5) * 0.3,
  }));

  function drawParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    for (let p of particles) {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fill();
      p.x += p.dx; p.y += p.dy;
      if (p.x < 0 || p.x > canvas.width) p.dx *= -1;
      if (p.y < 0 || p.y > canvas.height) p.dy *= -1;
    }
    requestAnimationFrame(drawParticles);
  }
  drawParticles();
  
  flipButton.addEventListener('click', function() {
    if (isFlipping) return;
    isFlipping = true;
    flipButton.disabled = true;
    result.textContent = "ç¿»è½¬ä¸­...";

    if (!isMuted) {
      flipSound.currentTime = 0;
      flipSound.play().catch(()=>{});
    }

    const isA = Math.random() < 0.5;
    const fullSpins = 5;
    const finalAngle = isA ? 0 : 180;
    const totalRotation = 360 * fullSpins + finalAngle;
    coin.style.transition = 'transform 2s cubic-bezier(0.25, 1, 0.5, 1)';
    coin.style.transform = `rotateY(${totalRotation}deg)`;

    setTimeout(() => {
      coin.style.transition = 'none';
      coin.style.transform = `rotateY(${finalAngle}deg)`;
      if (isA) {
        result.innerHTML = "æ˜¯ <strong>A</strong>ï¼";
        aCounter++; aCount.textContent = aCounter;
        if (effectsEnabled) createConfetti();
      } else {
        result.innerHTML = "æ˜¯ <strong>å‚»B :(</strong>";
        bCounter++; bCount.textContent = bCounter;
        if (effectsEnabled) createRainScene();
      }
      result.classList.add('celebrate');
      setTimeout(() => result.classList.remove('celebrate'), 500);
      totalFlips++; totalCount.textContent = totalFlips;

      setTimeout(() => {
        isFlipping = false;
        flipButton.disabled = false;
      }, 300);
    }, 2000);
  });

  // --- Prevent iOS double-tap zoom ---
  let lastTouchEnd = 0;
  document.addEventListener('touchend', function(event) {
    const now = (new Date()).getTime();
    if (now - lastTouchEnd <= 300) event.preventDefault();
    lastTouchEnd = now;
  }, false);
});
</script>


</body>
</html>
